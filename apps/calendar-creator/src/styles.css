/* --------- Design tokens --------- */
:root{
  --bg: #f6f8fb;
  --panel: #ffffff;
  --line: #d8d8d8;
  --shadow: 0 6px 18px rgba(18, 28, 45, .06);
  --text: #111827;
  --muted: #5b5f68;
  --primary: #2563eb;
  --primary-600: #1d4ed8;
  --radius: 14px;
  --focus-ring: 0 0 0 3px rgba(37, 99, 235, .20); /* matches --primary */
  --input-bg: #fff;
  --input-border: var(--line);
  --input-radius: 10px;

  /* calendar geometry */
  --cell-pad-x: 8px;        /* horizontal padding inside cell */
  --grid-line: 1px;         /* vertical line thickness */
  --head-h: 44px;           /* header row height (cosmetic) */
}

/* Reset-ish */
*{ box-sizing: border-box; }
html,body{ height:100%; }
body{
  margin:0; background:var(--bg); color:var(--text);
  font:14px/1.45 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
}

/* --------- Top bar --------- */
.topbar{
  position:sticky; top:0; z-index:20;
  background:rgba(255,255,255,.9); backdrop-filter:blur(8px);
  border-bottom:1px solid var(--line);
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 16px;
}
.topbar .left{ display:flex; align-items:center; gap:12px; }
.brand .title{ font-weight:800; letter-spacing:.2px; }
.brand .subtitle{ font-size:12px; color:var(--muted); }

.icon-btn{
  height:36px; min-width:36px; border-radius:10px; border:1px solid var(--line);
  background:#fff; cursor:pointer;
}

/* Menu / buttons */
.menu{ position:relative; }
.btn{
  height:36px; padding:0 14px; border-radius:10px; border:1px solid var(--line);
  background:#fff; color:var(--text); cursor:pointer; font-weight:600;
}
.btn:hover{ background:#f2f4f8; }
.btn--primary{ background:var(--primary); color:#fff; border-color:var(--primary); }
.btn--primary:hover{ background:var(--primary-600); }
.btn--sm{ height:32px; padding:0 10px; }

.menu__dropdown{
  position:absolute; top:42px; right:0; min-width:160px; background:#fff; border:1px solid var(--line);
  border-radius:12px; box-shadow:var(--shadow); padding:6px; display:none;
}
.menu__dropdown.open{ display:block; }
.menu__item{
  display:block; width:100%; text-align:left; border:0; background:transparent;
  padding:8px 10px; border-radius:8px; cursor:pointer;
}
.menu__item:hover{ background:#f6f8fb; }

/* App layout: never overflow horizontally */
.app{
  display:grid;
  /* left rail flexes between 260–300px, main takes the rest */
  grid-template-columns: minmax(260px,300px) minmax(0,1fr);
  gap:12px; /* was 16px */
  padding:16px;
  max-width:100%;
}

/* Drawer: no internal scroll; page scrolls instead */
.drawer{
  background:var(--panel);
  border:1px solid var(--line);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:14px;

  /* was height:calc(100vh - 90px); overflow:auto; */
  height:auto;
  max-height:none;
  overflow:visible;

  transition:transform .2s ease;
}
.drawer--closed{ transform:translateX(-110%); }
.drawer__section + .drawer__section{ border-top:1px dashed var(--line); margin-top:14px; padding-top:14px; }
.drawer h3{ margin:0 0 10px; font-size:12px; letter-spacing:.08em; text-transform:uppercase; color:var(--muted); }

/* Main surface should never grow beyond container */
.main{ display:flex; flex-direction:column; gap:12px; min-width:0; }

/* Fields */
.field{ display:flex; flex-direction:column; gap:6px; margin-bottom:8px; }
.field > span{ font-size:12px; color:var(--muted); }

.input,
.field input,
.field select,
.field textarea{
  height:36px;
  border:1px solid var(--input-border);
  border-radius:var(--input-radius);
  padding:0 10px;
  background:var(--input-bg);
  color:var(--text);
}

.field textarea{
  height:auto; min-height:72px; padding:8px 10px; resize:vertical;
}

/* Consistent focus everywhere */
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
.buttonlike:focus-visible{
  outline:none;
  box-shadow:var(--focus-ring);
  border-color: var(--primary);
}

/* Two-up fields */
.two{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }

/* Switch */
.switch{ display:flex; align-items:center; gap:10px; margin:8px 0; cursor:pointer; }
.switch input{ position:absolute; opacity:0; pointer-events:none; }
.switch__ui{
  width:46px; height:26px; border-radius:999px;
  background:#e5e7eb; position:relative;
  box-shadow:inset 0 0 0 1px #d1d5db;
  transition: background .15s ease;
}
.switch__ui::after{
  content:""; position:absolute; top:3px; left:3px;
  width:20px; height:20px; border-radius:50%;
  background:#fff; box-shadow:var(--shadow);
  transition: transform .2s ease;
}

/* Use --primary like .btn--primary */
.switch input:checked + .switch__ui{
  background: var(--primary);
  box-shadow: inset 0 0 0 1px var(--primary-600);
}
.switch input:checked + .switch__ui::after{ transform:translateX(20px); }

/* Panels */
.panel{
  background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow);
}
.panel__header{
  display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--line);
}
.panel__header h2{ margin:0; font-size:16px; font-weight:800; }
.panel__body{ padding:12px; }
.link{ background:transparent; border:0; color:var(--primary); font-weight:700; cursor:pointer; }

/* Events table */
.table-wrap{ overflow:auto; }
.table{ width:100%; border-collapse:separate; border-spacing:0; }
.table th,.table td{ border-bottom:1px solid var(--line); padding:8px; text-align:left; vertical-align:top; }
.table thead th{ position:sticky; top:0; background:#fff; z-index:1; }

/* Make table controls look like drawer controls */
.table input[type="date"],
.table select,
.table input[type="text"],
.table textarea{
  width:100%;
  height:36px;
  border:1px solid var(--input-border);
  border-radius:var(--input-radius);
  padding:0 10px;
  background:var(--input-bg);
  color:var(--text);
}
.table textarea{ height:36px; padding:8px 10px; }
.table input:focus-visible,
.table select:focus-visible,
.table textarea:focus-visible{
  outline:none; box-shadow:var(--focus-ring); border-color:var(--primary);
}

/* Sheet */
.sheet{
  background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow);
  padding:14px;
}
.sheet__header{ display:flex; align-items:flex-end; justify-content:space-between; margin-bottom:8px; }
.sheet__header h1{ margin:0; font-size:22px; font-weight:900; }
.sheet__body{display:grid; grid-template-columns: 1fr 300px; /* was 320px */ gap:12px; min-width:0; }
.notes{ border-top:1px dashed var(--line); margin-top:10px; padding-top:8px; }

/* Header typography */
.sheet__titlestack{ display:flex; flex-direction:column; gap:2px; min-width:0; }
.sheet__header h1{ margin:0; font-size:22px; font-weight:900; letter-spacing:.2px; }

.sheet__meta{
  display:flex; gap:6px; flex-wrap:wrap; align-items:center;
  color:var(--muted); font-size:12px; letter-spacing:.02em;
  min-height:1.2em;   /* keeps row height stable if empty */
}
.sheet__month{
  font-weight:800; color:var(--muted);
}

/* Prevent long company/description from forcing horizontal scroll */
.sheet__meta, .sheet__month{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* Calendar grid */
.calendar{
  position:relative;
  border:1px solid var(--line); border-radius:12px; overflow:hidden; background:#fff;
  display:grid; grid-template-columns:repeat(7,1fr);
}

/* header row */
.cal-head{
  grid-column: 1 / -1; display:grid; grid-template-columns:repeat(7,1fr);
  background:#f5f7fb; border-bottom:1px solid var(--line);
  height:var(--head-h); align-items:center;
}
.cal-head div{ padding:0 10px; font-weight:800; text-align:center; color:#374151; }

/* --- calendar column separators (works with or without .week wrappers) --- */

/* base: draw both left and right separators above pills */
.cell{
  position: relative;
  min-height: 120px;
  border-right: 0;
  border-bottom: 1px solid var(--line);
  padding: 24px var(--cell-pad-x) 8px;
  z-index: 0;
}
.cell::after, .cell::before{
  content:"";
  position:absolute; top:0; bottom:0;
  width:var(--grid-line); background:var(--line);
  z-index:2; pointer-events:none;
}
.cell::after{ right:0; }  /* right edge */
.cell::before{ left:0; }  /* left edge */

/* ── SHAPE A: .calendar has .cal-head then 42 .cell (no .week wrappers) ──
   - Saturday cells = 8th, 15th, 22nd, ...  -> 7n + 1
   - Sunday  cells = 2nd,  9th, 16th, ...   -> 7n + 2
*/
.calendar > .cell:nth-child(7n + 1)::after { display:none; } /* hide right line on Saturday */
.calendar > .cell:nth-child(7n + 2)::before{ display:none; } /* hide left line on Sunday */

/* ── SHAPE B: .calendar has .week rows, each with 7 .cell ──
   - Saturday in each row = 7th .cell
   - Sunday in each row   = 1st .cell
*/
.week > .cell:nth-child(7n)::after   { display:none; } /* Saturday: hide right */
.week > .cell:nth-child(7n + 1)::before{ display:none; } /* Sunday: hide left */

/* day number */
.cell .num{
  position:absolute; top:6px; right:8px;
  font-size:12px; color:#6b7280;
}

/* grey-out for outside-of-month cells */
.cell--out{ background:#fafbff; }
.cell--out .num{ color:#9ca3af; }

/* rows */
.week{ display:grid; grid-template-columns:repeat(7,1fr); column-gap:0; }

/* --- pills -------------------------------------------------------------- */
.pill{
  display:block;
  height:18px; line-height:18px;
  font-size:12px; color:#fff;
  padding:0 8px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  margin:4px 0;
  position:relative;
  z-index:1;                            /* pills under the separator line */
  border-radius:0;
}

/* Only show text on the first segment of a range */
.pill__label{ pointer-events:none; }                /* safety */
.pill--mid .pill__label,
.pill--end .pill__label{ display:none; }            /* keep bar, hide text */

/* Single-day: round both ends and cover full cell */
.pill--single{
  border-radius:999px;
  margin-left: calc(-1 * var(--cell-pad-x));
  width: calc(100% + var(--cell-pad-x) * 2);
}
/* Start of range */
.pill--start{
  border-top-left-radius:10px; border-bottom-left-radius:10px;
  margin-left: calc(-1 * var(--cell-pad-x));
  width: calc(100% + var(--cell-pad-x) * 2);
}
/* Middle of range: bleed across the grid gap and include padding */
.pill--mid{
  margin-left: calc(-1 * (var(--grid-line) + var(--cell-pad-x)));
  width: calc(100% + var(--grid-line) + var(--cell-pad-x) * 2);
}
/* End of range */
.pill--end{
  border-top-right-radius:10px; border-bottom-right-radius:10px;
  margin-left: calc(-1 * (var(--grid-line) + var(--cell-pad-x)));
  width: calc(100% + var(--grid-line) + var(--cell-pad-x) * 2);
}

/* Sidebar cards */
.sidecards{ display:flex; flex-direction:column; gap:12px; }
.card{ background:#fff; border:1px solid var(--line); border-radius:12px; box-shadow:var(--shadow); }
.card__head{ font-weight:800; padding:10px 12px; border-bottom:1px solid var(--line); }
.card__body{ padding:10px 12px; }

.eventcard{
  border:1px solid var(--line); border-radius:12px; margin-bottom:8px; overflow:hidden;
}
.eventcard__bar{ height:4px; background:#111827; }
.eventcard__body{ padding:8px 10px; }
.eventcard__title{ font-weight:800; }
.eventcard__meta{ font-size:12px; color:var(--muted); margin-top:4px; }

/* Export section */
.exportbar{ display:flex; justify-content:center; padding-bottom:30px; }

/* Modal */
.modal{ position:fixed; inset:0; background:rgba(9,12,22,.4); display:none; align-items:center; justify-content:center; z-index:40; }
.modal.open{ display:flex; }
.modal__dialog{
  width:540px; max-width:calc(100vw - 24px); background:#fff; border-radius:14px; box-shadow:var(--shadow); border:1px solid var(--line);
}
.modal__head{ display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--line); }
.modal__body{ padding:14px; }
.modal__foot{ padding:12px 14px; border-top:1px solid var(--line); display:flex; gap:8px; justify-content:flex-end; }
.grid2{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }

/* Utilities */
.muted{ color:var(--muted); }
.hidden{ display:none !important; }

/* Responsive */
@media (max-width:1100px){
  .sheet__body{ grid-template-columns:1fr; }
}
@media (max-width:900px){
  .app{ grid-template-columns:1fr; }
  .drawer{ position:fixed; left:16px; right:16px; top:68px; height:auto; max-height:70vh; overflow:auto; z-index:30; }
  .drawer--closed{ transform:translateY(-120%); }
}

/* Visually-hidden helper for accessible icon buttons */
.sr-only{
  position:absolute!important;
  width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;
  clip:rect(0,0,0,0);white-space:nowrap;border:0;
}

/* full-width button for the new add action */
.btn--block{ width:100%; }
#openCatModal{ margin-top:10px; }

/* Category editor */
.catlist{ display:flex; flex-direction:column; gap:10px; }

/* Use a tidy grid: [swatch] [name grows] [delete button] */
.catrow{
  display:grid;
  grid-template-columns: 40px 1fr auto;
  gap:10px;
  align-items:center;
  padding-right:10px;                   /* <-- new: matches the 10px grid gap */
}

/* Larger, rounded color swatch */
.catrow input[type="color"]{
  -webkit-appearance: none;
  appearance: none;
  width:40px; height:32px; padding:0; border:0;
  border-radius:8px; cursor:pointer;
  box-shadow: inset 0 0 0 1px rgba(0,0,0,.08);
}
.catrow input[type="color"]::-webkit-color-swatch-wrapper{ padding:0; }
.catrow input[type="color"]::-webkit-color-swatch{ border:none; border-radius:8px; }

/* Icon-only delete button */
.btn--icon{
  height:32px; width:32px; padding:0;
  display:inline-flex; align-items:center; justify-content:center;
  border-radius:8px;
}
.btn--icon:hover{ background:#f2f4f8; }

/* Name field matches other inputs */
.catrow input[type="text"]{
  height:36px;
  border:1px solid var(--input-border);
  border-radius:var(--input-radius);
  padding:0 10px;
  background:#fff; color:var(--text);
}

/* Delete button spacing stays readable on small screens */
.catrow .btn{ white-space:nowrap; }

/* Add-category row: separate and airy */
.addcat{ display:grid; grid-template-columns: 1fr 40px auto; gap:10px; margin-top:10px; }
.addcat input[type="text"]{
  height:36px; border:1px solid var(--input-border);
  border-radius:var(--input-radius); padding:0 10px;
}
.addcat input[type="color"]{
  width:40px; height:32px; padding:0; border:0; border-radius:8px; box-shadow: inset 0 0 0 1px rgba(0,0,0,.08);
}

/* Shortcuts toolbar */
.shortcutbar{
  display:flex; gap:8px; align-items:center;
  padding:0 12px 8px 12px;
}

